#
# DO NOT EDIT THIS FILE MANUALLY
# This makefile was automatically generated
# Directory : ffti
# Package   : Fast Fourier Transform Interface
# Version   : 0.1.0
# Authors   : Giovanni Bussi (adapted from ESPRESSO package)
#
# Today is Thu Jan 26 19:51:14 CET 2012
#
# Global OPTIONS file has been used in generation
# Local OPTIONS file has been used in generation
#
# Sources defined by: *.f90 *.c *.f
#
# List of MAIN source files
# (Fortran files containing a program statement):
# test_1dz.f90 test_3d.f90 
#
# List of LIB source files
# (Fortran files NOT containing a program statement and c files):
#  ffti_base.f90 ffti_external.f90 ffti_interface.f90 ffti_module.f90
# ffti_singleton.f90 ffti_fftw_wrappers.c 
#
# Used libraries
# blas fftw
#
# Linked libraries
# scsl essl complib
#
# The real Makefile starts here
#
# IDE HOME variable set to DEFAULT
IDEHOME=../..
#
# Objects to be linked in the library
OBJ_LIB= ffti_base.o ffti_external.o ffti_interface.o ffti_module.o\
 ffti_singleton.o ffti_fftw_wrappers.o

#

# Macros to link the present library
# (may be change by make.sys to the path of installed library)
LIB_FFTI=libffti.a
LIB_FFTI_INCLUDE=-I. -I$(IDEHOME)/ffti/include

# Switch to enable actual compilation
# (may be change by make.sys to "external")
LIB_FFTI_SWITCH=internal
# Options to link the FFTW library
LIB_FFTW=$(IDEHOME)/fftw/src/libfftw.a
LIB_FFTW_INCLUDE=-I$(IDEHOME)/fftw/src/   -I$(IDEHOME)/fftw/include

# Options to link the BLAS library
LIB_BLAS=$(IDEHOME)/blas/src/libblas.a
LIB_BLAS_INCLUDE=-I$(IDEHOME)/blas/src/   -I$(IDEHOME)/blas/include

# Options to link the COMPLIB library
LIB_COMPLIB=
LIB_COMPLIB_INCLUDE=

# Options to link the ESSL library
LIB_ESSL=
LIB_ESSL_INCLUDE=

# Options to link the SCSL library
LIB_SCSL=
LIB_SCSL_INCLUDE=

# Path for include
AUTO_INCLUDE=$(LIB_FFTI_INCLUDE) $(LIB_FFTW_INCLUDE) $(LIB_BLAS_INCLUDE)\
 $(LIB_COMPLIB_INCLUDE) $(LIB_ESSL_INCLUDE) $(LIB_SCSL_INCLUDE) 

# List of used library files
AUTO_LIBS=$(LIB_FFTI) $(LIB_FFTW) $(LIB_BLAS) $(LIB_COMPLIB) $(LIB_ESSL)\
 $(LIB_SCSL) 
# Inclusion of system dependent files
include $(IDEHOME)/make.sys
# Macro (re)definitions from OPTIONS file (keyword DEFINITION)
PRECISION = $(FAUTODBL)

# Main target
# INFO print a short help
info:
	@make print_info
# INFO make local library and all executables
all:
	make loclib
	make test_1dz.x
	make test_3d.x

# INFO make local library
loclib: libs loclib_only

loclib_only: ide_$(LIB_FFTI_SWITCH)

ide_internal: libffti.a

ide_external: fake_external.a

fake_external.a:
	touch $(OBJ_LIB)
	touch libffti.a
	touch fake_external.a
# Targets for executables
# INFO make program test_1dz.x
test_1dz.x: test_1dz.o libffti.a $(IDEHOME)/fftw/src/libfftw.a $(IDEHOME)/blas/src/libblas.a
	make loclib_only
	$(LD) $(LDFLAGS) -o test_1dz.x test_1dz.o $(LIBOBJS) $(LIBS)
	cd $(IDEHOME)/ffti/bin ;   ln -sf $(IDEHOME)/ffti/src/test_1dz.x . 
# INFO make program test_3d.x
test_3d.x: test_3d.o libffti.a $(IDEHOME)/fftw/src/libfftw.a $(IDEHOME)/blas/src/libblas.a
	make loclib_only
	$(LD) $(LDFLAGS) -o test_3d.x test_3d.o $(LIBOBJS) $(LIBS)
	cd $(IDEHOME)/ffti/bin ;   ln -sf $(IDEHOME)/ffti/src/test_3d.x . 


# Targets for libraries
# INFO make local library (without the used libraries)
libffti.a: $(OBJ_LIB)
	$(AR) $(ARFLAGS) libffti.a $(OBJ_LIB)
	$(RANLIB) libffti.a

# INFO make all the used libs
libs:
	cd $(IDEHOME)/blas/src ; make loclib_only
	cd $(IDEHOME)/fftw/src ; make loclib_only


# target for making Makefile
# INFO make local Makefile
make: 
	cd $(IDEHOME) ; IDE/makemake.sh ffti 

# INFO make local and libs Makefiles
allmake:
	cd $(IDEHOME) ; IDE/makemake.sh blas 
	cd $(IDEHOME) ; IDE/makemake.sh fftw 
	cd $(IDEHOME) ; IDE/makemake.sh ffti 


# target for cleaning
clean_: clean
# INFO cleanup
clean: 
	- rm -f *.a *.o *.mod *.d *.pc *.pcl *.x *.F90
	if test -d  $(IDEHOME)/ffti/tmp/CVS  ; then \
	mv  $(IDEHOME)/ffti/tmp/CVS \
	$(IDEHOME)/ffti/tmp/.CVS ; fi
	- rm -rf $(IDEHOME)/ffti/tmp/*
	if test -d  $(IDEHOME)/ffti/tmp/.CVS  ; then \
	mv  $(IDEHOME)/ffti/tmp/.CVS  \
	$(IDEHOME)/ffti/tmp/CVS ; fi
	- rm -f $(IDEHOME)/ffti/bin/*.x 

tarlist: 
	cd $(IDEHOME) ; IDE/tarlist.sh ffti > ffti/tmp/tarlist

# INFO gzipped tar
tar: tarlist
	cd $(IDEHOME) ;         tar cf ffti-0.1.0.tar `cat ffti/tmp/tarlist`
	cd $(IDEHOME) ; gzip -9 ffti-0.1.0.tar

# INFO gzipped tar including used libraries and IDE
alltar: 
	cd $(IDEHOME) ;         tar cf ffti-0.1.0-withdeps.tar IDE CONFIG configure Makefile
	cd $(IDEHOME) ;         tar rf ffti-0.1.0-withdeps.tar OPTIONS
	cd $(IDEHOME) ;          tar rf ffti-0.1.0-withdeps.tar `cat ffti/tmp/tarlist`
	cd $(IDEHOME)/blas/src ; make tarlist
	cd $(IDEHOME) ; tar rf ffti-0.1.0-withdeps.tar `cat blas/tmp/tarlist`
	cd $(IDEHOME)/fftw/src ; make tarlist
	cd $(IDEHOME) ; tar rf ffti-0.1.0-withdeps.tar `cat fftw/tmp/tarlist`
	cd $(IDEHOME) ; gzip -9 ffti-0.1.0-withdeps.tar

# Directly added lines from OPTIONS file (keyword MAKEFILE)
# Nothing found
# Special rules for selected files (keyword DEFINITION.filebase)
# Special rules
ffti_singleton.o: ffti_singleton.f90
	make -f Makefile.ffti_singleton ffti_singleton.o



print_info:
	@echo " Package : Fast Fourier Transform Interface"
	@echo " Version : 0.1.0"
	@echo " Authors : Giovanni Bussi (adapted from ESPRESSO package)"
	@echo
	@echo " type:  make <target>"
	@echo " Possible <target>'s are:"
	@echo "  info                           print a short help"
	@echo "  all                            make local library and all executables"
	@echo "  loclib                         make local library"
	@echo "  test_1dz.x                     make program test_1dz.x"
	@echo "  test_3d.x                      make program test_3d.x"
	@echo "  libffti.a                      make local library (without the used libraries)"
	@echo "  libs                           make all the used libs"
	@echo "  make                           make local Makefile"
	@echo "  allmake                        make local and libs Makefiles"
	@echo "  clean                          cleanup"
	@echo "  tar                            gzipped tar"
	@echo "  alltar                         gzipped tar including used libraries and IDE"
	@echo # Dependencies
ffti_base.o : ../include/ffti_fdefs.h
ffti_external.o : ../include/ffti_fdefs.h
ffti_external.o : ffti_base.o
ffti_external.o : ffti_interface.o
ffti_external.o : ffti_singleton.o
ffti_interface.o : ../include/ffti_fdefs.h
ffti_interface.o : ffti_base.o
ffti_module.o : ffti_base.o
ffti_module.o : ffti_interface.o
test_1dz.o : ffti_module.o
test_3d.o : ffti_module.o
# End dependencies
